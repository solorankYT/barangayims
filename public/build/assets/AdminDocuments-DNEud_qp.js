import{K as A,r as c,j as e,S as p}from"./app-BUJ-Xs52.js";import{A as R}from"./AuthenticatedLayout-cLHCBzW-.js";import{B as v,I as T}from"./index-DhyXgqfG.js";import{T as u,D as w,a as P,b as L,c as E}from"./TextField-DtEF5oPB.js";import{I as U,S as B}from"./Search-CPsxp5Z_.js";import{B as h,P as W}from"./Menu-BBYLuhnE.js";import{A as O,E as N,D as _}from"./Edit-B-_es7x1.js";import{T as $,a as F,b as H,c as x,d as t,e as K}from"./TableRow-XQUvRJBl.js";import{A as g}from"./Autocomplete-BLYPNwWp.js";import"./useControlled-dll_wIeD.js";import"./MenuItem-DcNJRPM_.js";import"./index-Bim1y6ZO.js";import"./Report-DqM0_vN-.js";import"./Close-BEU_eJTi.js";const oe=()=>{const{documentRequests:y=[],documentTypes:j=[],users:D=[]}=A().props,[b,m]=c.useState(!1),[a,C]=c.useState(!1),[i,k]=c.useState(""),[n,l]=c.useState({documentRequestID:null,userID:null,documentTypeID:null,status:"Pending",purpose:"",remarks:"",documentID:null}),I=(s=null)=>{C(!!s),l(s?{...s}:{documentRequestID:null,userID:null,documentTypeID:null,status:"Pending",purpose:"",remarks:"",documentID:null}),m(!0)},d=()=>{m(!1),l({documentRequestID:null,userID:null,documentTypeID:null,status:"Pending",purpose:"",remarks:"",documentID:null})},S=()=>{if(!n.userID||!n.documentTypeID||!n.purpose){alert("User, Document Type, and Purpose are required.");return}const s={userID:n.userID,documentTypeID:n.documentTypeID,purpose:n.purpose,remarks:n.remarks,documentID:null,status:a?n.status:"Pending"};a?p.put(`/AdminDocuments/${n.documentRequestID}`,s,{onSuccess:()=>d()}):p.post("/AdminDocuments",s,{onSuccess:()=>d()})},q=s=>{window.confirm("Are you sure you want to delete this document request?")&&p.delete(`/AdminDocuments/${s}`,{onSuccess:()=>m(!1)})},f=y.filter(s=>{var r,o;return((r=s.user)==null?void 0:r.name.toLowerCase().includes(i.toLowerCase()))||((o=s.document_type)==null?void 0:o.name.toLowerCase().includes(i.toLowerCase()))||s.status.toLowerCase().includes(i.toLowerCase())});return e.jsx(R,{header:"Document and Record",children:e.jsxs(v,{sx:{width:"100%",padding:3},children:[e.jsx(u,{variant:"outlined",placeholder:"Search...",fullWidth:!0,value:i,onChange:s=>k(s.target.value),sx:{mb:2},InputProps:{startAdornment:e.jsx(U,{position:"start",children:e.jsx(B,{})})}}),e.jsx(h,{variant:"contained",color:"primary",startIcon:e.jsx(O,{}),onClick:()=>I(),sx:{mb:2},children:"Add New Request"}),e.jsx($,{component:W,children:e.jsxs(F,{children:[e.jsx(H,{children:e.jsxs(x,{children:[e.jsx(t,{children:e.jsx("b",{children:"ID"})}),e.jsx(t,{children:e.jsx("b",{children:"User"})}),e.jsx(t,{children:e.jsx("b",{children:"Document Type"})}),e.jsx(t,{children:e.jsx("b",{children:"Status"})}),e.jsx(t,{children:e.jsx("b",{children:"Purpose"})}),e.jsx(t,{children:e.jsx("b",{children:"Remarks"})}),e.jsx(t,{children:e.jsx("b",{children:"Actions"})})]})}),e.jsx(K,{children:f.length>0?f.map(s=>{var r,o;return e.jsxs(x,{children:[e.jsx(t,{children:s.documentRequestID}),e.jsx(t,{children:((r=s.user)==null?void 0:r.name)||"Unknown User"}),e.jsx(t,{children:((o=s.document_type)==null?void 0:o.name)||"Unknown Document Type"}),e.jsx(t,{children:s.status}),e.jsx(t,{children:s.purpose}),e.jsx(t,{children:s.remarks}),e.jsxs(t,{children:[e.jsx(T,{onClick:()=>I(s),color:"primary",children:e.jsx(N,{})}),e.jsx(T,{onClick:()=>q(s.documentRequestID),color:"error",children:e.jsx(_,{})})]})]},s.documentRequestID)}):e.jsx(x,{children:e.jsx(t,{colSpan:7,align:"center",children:"No document requests found."})})})]})}),e.jsxs(w,{open:b,onClose:d,children:[e.jsx(P,{children:a?"Edit Document Request":"New Document Request"}),e.jsxs(L,{children:[e.jsx(g,{options:D,getOptionLabel:s=>s.name||"",value:D.find(s=>s.id===n.userID)||null,onChange:(s,r)=>{l(o=>({...o,userID:r?r.id:null}))},renderInput:s=>e.jsx(u,{...s,label:"User",fullWidth:!0,margin:"dense",required:!0})}),e.jsx(g,{options:j,getOptionLabel:s=>s.name||"",value:j.find(s=>s.documentTypeID===n.documentTypeID)||null,onChange:(s,r)=>{l(o=>({...o,documentTypeID:r?r.documentTypeID:null}))},renderInput:s=>e.jsx(u,{...s,label:"Document Type",fullWidth:!0,margin:"dense",required:!0})}),e.jsx(u,{label:"Purpose",fullWidth:!0,margin:"dense",name:"purpose",value:n.purpose,onChange:s=>l({...n,purpose:s.target.value}),required:!0}),e.jsx(u,{label:"Remarks",fullWidth:!0,margin:"dense",name:"remarks",value:n.remarks,onChange:s=>l({...n,remarks:s.target.value})})]}),e.jsxs(E,{children:[e.jsx(h,{onClick:d,color:"secondary",children:"Cancel"}),e.jsx(h,{onClick:S,color:"primary",children:a?"Update":"Save"})]})]})]})})};export{oe as default};
