import{r as n,a as h,j as e}from"./app-BUJ-Xs52.js";import{A as u,C as f}from"./AuthenticatedLayout-cLHCBzW-.js";import{B as x}from"./index-DhyXgqfG.js";import{G as c}from"./Grid-pnX0zcTp.js";import{C as g,a as b}from"./CardContent-B-eIVxiP.js";import{T as i,B as m,P as w}from"./Menu-BBYLuhnE.js";import{T as C,a as W,b as v,c as o,d as a,e as T}from"./TableRow-XQUvRJBl.js";import"./useControlled-dll_wIeD.js";import"./MenuItem-DcNJRPM_.js";import"./index-Bim1y6ZO.js";import"./Report-DqM0_vN-.js";function G(){const[d,j]=n.useState([]),[t,p]=n.useState(null);n.useEffect(()=>{l()},[]);const l=async()=>{try{const r=await h.get("/fetchWeatherData");if(r.data){const s=Array.isArray(r.data)?r.data:[r.data];j(s),s.length>0&&p(s[0])}else console.error("Unexpected response format:",r.data)}catch(r){console.error("Error fetching weather history:",r)}},y=async()=>{try{await h.get("/fetchAndStoreWeatherData"),l()}catch(r){console.error("Error fetching current weather:",r)}};return e.jsx(u,{header:"Weather Management",children:e.jsxs(x,{sx:{width:"100%",padding:3},children:[e.jsxs(c,{container:!0,spacing:2,sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:[e.jsx(c,{item:!0,xs:12,md:4,children:t&&e.jsx(g,{sx:{borderRadius:3,boxShadow:3},children:e.jsxs(b,{children:[e.jsxs(i,{variant:"h6",gutterBottom:!0,children:[e.jsx(f,{sx:{verticalAlign:"middle",mr:1}}),"Weather Update"]}),e.jsxs(i,{variant:"subtitle1",children:[t.city,", ",t.country]}),e.jsx(i,{variant:"body2",color:"textSecondary",children:t.region}),e.jsxs("div",{style:{display:"flex",alignItems:"center",marginTop:10},children:[e.jsx("img",{src:t.weather_icon,alt:t.weather_description,width:"50"}),e.jsxs("div",{style:{marginLeft:10},children:[e.jsxs(i,{variant:"h4",children:[t.temperature,"°C"]}),e.jsx(i,{children:t.weather_description})]})]}),e.jsxs(i,{variant:"caption",color:"textSecondary",children:["Updated: ",new Date(t.created_at).toLocaleString()]})]})})}),e.jsx(c,{item:!0,xs:12,md:4,sx:{display:"flex",flexDirection:{xs:"row",md:"column"},gap:2,alignItems:"center",justifyContent:"center"},children:e.jsxs(x,{sx:{display:"flex",width:"100%",gap:2},children:[e.jsx(m,{variant:"contained",color:"primary",onClick:y,sx:{maxWidth:300,width:"100%",flex:1,minHeight:50},children:"Fetch Current Weather"}),e.jsx(m,{variant:"contained",color:"primary",sx:{maxWidth:300,width:"100%",flex:1,minHeight:50},children:"Send to Residents"})]})})]}),e.jsx(i,{variant:"h5",sx:{mt:4},children:"History"}),e.jsx(C,{component:w,sx:{mt:2},children:e.jsxs(W,{children:[e.jsx(v,{children:e.jsxs(o,{children:[e.jsx(a,{children:e.jsx("b",{children:"Date"})}),e.jsx(a,{children:e.jsx("b",{children:"Temperature (°C)"})}),e.jsx(a,{children:e.jsx("b",{children:"Humidity (%)"})}),e.jsx(a,{children:e.jsx("b",{children:"Weather"})})]})}),e.jsx(T,{children:d.length>0?d.map(r=>e.jsxs(o,{children:[e.jsx(a,{children:new Date(r.created_at).toLocaleString()}),e.jsx(a,{children:r.temperature}),e.jsx(a,{children:r.humidity}),e.jsx(a,{children:r.weather_description})]},r.id)):e.jsx(o,{children:e.jsx(a,{colSpan:5,align:"center",children:"No weather history available."})})})]})})]})})}export{G as default};
